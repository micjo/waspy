{% extends "base.html" %}

{% macro buttonSpinner(text, onclick, spinnerId) -%}
    <button type="button" class="btn btn-primary" onclick="{{ onclick }}">
        <span class="spinner-border spinner-border-sm" id="{{ spinnerId }}" role="status" style="display:none"></span>
         {{ text }}
    </button>
{% endmacro -%}

{% block title %}Welcome{% endblock %}

{% block content %}
<script type="module">
    // It is not recommended to add all the calls to the window as this pollutes the global namespace
    // unfortunately my javascript knowledge is not sufficient to figure out a better way
    import * as min_itf from '{{url_for('static', filename='min_itf.js')}}'
    window.onSubmitAmlXY = min_itf.onSubmitAmlXY
    window.onLoadAmlXY = min_itf.onLoadAmlXY
    window.onUnLoadAmlXY = min_itf.onUnLoadAmlXY
    window.onContinueAmlXY = min_itf.onContinueAmlXY
    window.onSubmitAmlDetTheta = min_itf.onSubmitAmlDetTheta
    window.onLoadAmlDetTheta = min_itf.onLoadAmlDetTheta
    window.onUnLoadAmlDetTheta = min_itf.onUnLoadAmlDetTheta
    window.onContinueAmlDetTheta = min_itf.onContinueAmlDetTheta
    window.onSubmitAmlPhiZeta = min_itf.onSubmitAmlPhiZeta
    window.onLoadAmlPhiZeta = min_itf.onLoadAmlPhiZeta
    window.onUnLoadAmlPhiZeta = min_itf.onUnLoadAmlPhiZeta
    window.onContinueAmlPhiZeta = min_itf.onContinueAmlPhiZeta
    window.min_itf = min_itf;
</script>
<hr>
<div class="left-to-right"><h5>AML x_y  </h5>
    <h5><span class="badge badge-danger" id="aml_x_y_connect_status">Disconnected</span></h5>
</div>
<hr>
<div class="full-width">
    <div class="row justify-content-between">
        <div class="col-2">Time:</div>
        <div class="col-10"><h5><span class="badge badge-info" id="aml_x_y_time">-</span></h5></div> 
    </div>
    <div class="row justify-content-between">
        <div class="col-2">Request acknowledge:</div>
        <div class="col-10"><h5><span class="badge badge-info" id="aml_x_y_request_id">-</span></h5></div> 
    </div>
    <div class="row justify-content-between">
        <div class="col-2">Expiry Date:</div>
        <div class="col-10"><h5><span class="badge badge-info" id="aml_x_y_expiry_date">-</span></h5></div> 
    </div>
    <div class="row justify-content-between">
        <div class="col-2">Busy:</div>
        <div class="col-10"><h5><span class="badge badge-info" id="aml_x_y_busy_status">-</span></h5></div> 
    </div>
    <div class="row justify-content-between">
        <div class="col-2">X:</div>
        <div class="col-6"><h5><span class="badge badge-info" id="aml_x_y_first">-</span></h5></div> 
        <div class="col-4"><input class="float-right" type="text" id="aml_x_y_first_request" placeholder="X"></div>
    </div>
    <div class="row justify-content-between">
        <div class="col-2">Y:</div>
        <div class="col-6"><h5><span class="badge badge-info" id="aml_x_y_second">-</span></h5></div> 
        <div class="col-4"><input class="float-right" type="text" id="aml_x_y_second_request" placeholder="Y"></div>
    </div>
</div>
<div class="input text-right push">
    {{ buttonSpinner('Submit', 'min_itf.onSubmitAmlXY()', 'aml_x_y_submit_spinner') }}
    {{ buttonSpinner('Load', 'min_itf.onLoadAmlXY()', 'aml_x_y_load_spinner') }}
    {{ buttonSpinner('Unload', 'min_itf.onUnLoadAmlXY()', 'aml_x_y_unload_spinner') }}
    {{ buttonSpinner('Continue', 'min_itf.onContinueAmlXY()', 'aml_x_y_continue_spinner') }}
</div>
<div id="aml_x_y_error_status"></div>
<div id="aml_x_y_request_status"></div>

<hr>
<div class="left-to-right"><h5>AML det theta</h5>
    <h5><span class="badge badge-danger" id="aml_det_theta_connect_status">Disconnected</span></h5>
</div>
<hr>
<div class="full-width">
    <div class="row justify-content-between">
        <div class="col-2">Timestamp</div>
        <div class="col-10"><h5><span class="badge badge-info" id="aml_det_theta_request_id">-</span></h5></div> 
    </div>
    <div class="row justify-content-between">
        <div class="col-2">det:</div>
        <div class="col-6"><h5><span class="badge badge-info" id="aml_det_theta_first">-</span></h5></div> 
        <div class="col-4"><input class="float-right" type="text" id="aml_det_theta_first_request" placeholder="det"></div>
    </div>
    <div class="row justify-content-between">
        <div class="col-2">theta:</div>
        <div class="col-6"><h5><span class="badge badge-info" id="aml_det_theta_second">-</span></h5></div> 
        <div class="col-4"><input class="float-right" type="text" id="aml_det_theta_second_request" placeholder="theta"></div>
    </div>
</div>
<div class="input text-right push">
    <button type="button" class="btn btn-primary padded" onclick="onSubmitAmlDetTheta()">Submit</button>
    <button type="button" class="btn btn-primary padded" onclick="onLoadAmlDetTheta()">Load</button>
    <button type="button" class="btn btn-primary padded" onclick="onUnLoadAmlDetTheta()">Unload</button>
    <button type="button" class="btn btn-primary padded" onclick="onContinueAmlDetTheta()">Continue</button>
</div>
<div id="aml_det_theta_error_status"></div>
<div id="aml_det_theta_request_status"></div>
<div id="aml_det_theta_busy_status" class="spinner-border" role="status" style="display:none">
    <span class="sr-only">Loading...</span>
</div>

<hr>
<div class="left-to-right"><h5>AML phi zeta</h5>
    <h5><span class="badge badge-danger" id="aml_phi_zeta_connect_status">Disconnected</span></h5>
</div>
<hr>
<div class="full-width">
<div class="row justify-content-between">
    <div class="col-2">Timestamp</div>
    <div class="col-10"><h5><span class="badge badge-info" id="aml_phi_zeta_request_id">-</span></h5></div> 
</div>
<div class="row justify-content-between">
    <div class="col-2">phi:</div>
    <div class="col-6"><h5><span class="badge badge-info" id="aml_phi_zeta_first">-</span></h5></div> 
    <div class="col-4"><input class="float-right" type="text" id="aml_phi_zeta_first_request" placeholder="phi"></div>
</div>
<div class="row justify-content-between">
    <div class="col-2">zeta:</div>
    <div class="col-6"><h5><span class="badge badge-info" id="aml_phi_zeta_second">-</span></h5></div> 
    <div class="col-4"><input class="float-right" type="text" id="aml_phi_zeta_second_request" placeholder="zeta"></div>
</div>
</div>
<div class="input text-right push">
    <button type="button" class="btn btn-primary padded" onclick="onSubmitAmlPhiZeta()">Submit</button>
    <button type="button" class="btn btn-primary padded" onclick="onLoadAmlPhiZeta()">Load</button>
    <button type="button" class="btn btn-primary padded" onclick="onUnLoadAmlPhiZeta()">Unload</button>
    <button type="button" class="btn btn-primary padded" onclick="onContinueAmlPhiZeta()">Continue</button>
</div>
<div id="aml_phi_zeta_error_status"></div>
<div id="aml_phi_zeta_request_status"></div>
<div id="aml_phi_zeta_busy_status" class="spinner-border" role="status" style="display:none">
    <span class="sr-only">Loading...</span>
</div>

<hr>
<div class="left-to-right"><h5>CAEN </h5>
    <h5><span class="badge badge-danger" id="caen_connect_status">Disconnected</span></h5>
</div>
<hr>
<div class="full-width">
<div class="row justify-content-between">
    <div class="col-2">Time:</div>
    <div class="col-10"><h5><span class="badge badge-info" id="caen_time">-</span></h5></div> 
</div>
<div class="row justify-content-between">
    <div class="col-2">Request acknowledge:</div>
    <div class="col-10"><h5><span class="badge badge-info" id="caen_request_id">-</span></h5></div> 
</div>
<div class="row justify-content-between">
    <div class="col-2">Acquiring Data:</div>
    <div class="col-10"><h5><span class="badge badge-info" id="caen_acquiring_data">-</span></h5></div>
</div>
<div class="row justify-content-between">
    <div class="col-2">Storing List Data:</div>
    <div class="col-10"><h5><span class="badge badge-info" id="caen_storing_list_data">-</span></h5></div>
</div>
<div class="row justify-content-between">
    <div class="col-2">Histogram name:</div>
    <div class="col-6"><h5><span class="badge badge-info" id="caen_histogram_folder">-</span></h5></div>
    <div class="col-4"><input type="text" id="caen_histogram_folder_request" placeholder="histogram folder" class="float-right"></div>
</div>
<div class="row justify-content-between">
    <div class="col-2">List data name:</div>
    <div class="col-6"><h5><span class="badge badge-info" id="caen_list_data_folder">-</span></h5></div>
    <div class="col-4"><input type="text" id="caen_list_data_folder_request" placeholder="listdata folder" class="float-right"></div>
</div>
<div class="row justify-content-between">
    <div class="col-2">List data timeout (min):</div>
    <div class="col-6"><h5><span class="badge badge-info" id="caen_list_data_timeout">-</span></h5></div>
    <div class="col-4"><input type="text" id="caen_list_data_timeout_request" placeholder="listdata timeout" class="float-right"></div>
</div>
</div>

<div class="input text-right push">
    <button type="button" class="btn btn-secondary" onclick="min_itf.toggleAcquisition()" id="caen_toggle_acquisition">
         <span class="spinner-border spinner-border-sm" id="caen_toggle_acquisition_spinner" role="status" style="display:none"></span>
         <span id="caen_toggle_acquisition_text" >Not acquiring data</span>
    </button>
    <button type="button" class="btn btn-secondary padded" onclick="min_itf.toggleListData()" id="caen_toggle_list_data">
         <span class="spinner-border spinner-border-sm" id="caen_toggle_list_data_spinner" role="status" style="display:none"></span>
         <span id="caen_toggle_list_data_text" >Not acquiring data</span>
    </button>
    {{ buttonSpinner('Clear Data', 'min_itf.caenClearData()', 'caen_clear_data_spinner') }}
    {{ buttonSpinner('Save histogram', 'min_itf.caenSaveHistogram()', 'caen_save_histogram_spinner') }}
    {{ buttonSpinner('Continue', 'min_itf.caenContinueOnError()', 'caen_continue_spinner') }}
    {{ buttonSpinner('Save registry', 'min_itf.caenSaveRegistry()', 'caen_save_registry_spinner') }}
</div>
<div id="caen_error_status"></div>
<div id="caen_request_status"></div>
</div>

{% endblock %}
