{% extends "base.html" %}
{% import "ui_elements.html" as ui_elements %}
{% block title %}Welcome{% endblock %}

{% block content %}
<script type="module">
    // It is not recommended to add all the calls to the window as this pollutes the global namespace
    // unfortunately my javascript knowledge is not sufficient to figure out a better way
    import * as itf from '{{url_for('static', filename='itf.js')}}'
    window.itf = itf;
    window.setInterval(function() {
        itf.refreshData();
    }, 2000);
</script>

<!-- For future use: these should come from the flask server -->
{% set prefix1 = 'aml_x_y' %}
{% set prefix2 = 'aml_det_theta' %}
{% set prefix3 = 'aml_phi_zeta' %}
{% set prefix4 = 'caen' %}

<hr>
<div class="left-to-right"><h5>AML x_y  </h5>
    <h5><span class="badge bg-danger" id="{{prefix1}}_connect_status">Not running</span></h5>
</div>
<hr>
<div class="full-width">
    {{ ui_elements.dataLabelWithBadge("Time:", prefix1+"_time") }}
    {{ ui_elements.dataLabelWithBadge("Request Acknowledge:", prefix1+"_request_id") }}
    {{ ui_elements.dataLabelWithBadge("Expiry Date:", prefix1+"_expiry_date") }}
    {{ ui_elements.dataLabelWithBadge("Status:", prefix1+"_busy_status") }}
    {{ ui_elements.dataLabelWithBadgeAndInput('X:', prefix1+'_first', prefix1+'_first_request', 'X') }}
    {{ ui_elements.dataLabelWithBadgeAndInput('Y:', prefix1+'_second', prefix1+'_second_request', 'Y') }}
</div>
<div class="push-right">
    {{ ui_elements.buttonSpinner('Submit', prefix1 + '_submit_spinner', 'itf.onSubmitAmlXY()') }}
    {{ ui_elements.buttonSpinner('Load/Unload', prefix1 + '_load_spinner', 'itf.onLoadAmlXY()') }}
    {{ ui_elements.buttonSpinner('Continue', prefix1 + '_continue_spinner', 'itf.onContinueAmlXY()') }}
    {{ ui_elements.buttonSpinner('Hide', prefix1 + '_hide_spinner', 'itf.onHideAmlXY()') }}
    {{ ui_elements.buttonSpinner('Show', prefix1 + '_show_spinner', 'itf.onShowAmlXY()') }}
</div>
<div id="{{prefix1}}_error_status" ></div>
<div id="{{prefix1}}_request_status"></div>

<hr>
<div class="left-to-right"><h5>AML det_theta  </h5>
    <h5><span class="badge bg-danger" id="{{prefix2}}_connect_status">Not running</span></h5>
</div>
<hr>
<div class="full-width">
    {{ ui_elements.dataLabelWithBadge("Time:", prefix2+"_time") }}
    {{ ui_elements.dataLabelWithBadge("Request Acknowledge:", prefix2+"_request_id") }}
    {{ ui_elements.dataLabelWithBadge("Expiry Date:", prefix2+"_expiry_date") }}
    {{ ui_elements.dataLabelWithBadge("Status:", prefix2+"_busy_status") }}
    {{ ui_elements.dataLabelWithBadgeAndInput('X:', prefix2+'_first', prefix2+'_first_request', 'X') }}
    {{ ui_elements.dataLabelWithBadgeAndInput('Y:', prefix2+'_second', prefix2+'_second_request', 'Y') }}
</div>
<div class="push-right">
    {{ ui_elements.buttonSpinner('Submit', prefix2 + '_submit_spinner', 'itf.onSubmitAmlDetTheta()') }}
    {{ ui_elements.buttonSpinner('Load/Unload', prefix2 + '_load_spinner', 'itf.onLoadAmlDetTheta()') }}
    {{ ui_elements.buttonSpinner('Continue', prefix2 + '_continue_spinner', 'itf.onContinueAmlDetTheta()') }}
    {{ ui_elements.buttonSpinner('Hide', prefix2 + '_hide_spinner', 'itf.onHideAmlDetTheta()') }}
    {{ ui_elements.buttonSpinner('Show', prefix2 + '_show_spinner', 'itf.onShowAmlDetTheta()') }}
</div>
<div id="{{prefix2}}_error_status" ></div>
<div id="{{prefix2}}_request_status"></div>

<hr>
<div class="left-to-right"><h5>AML phi_zeta  </h5>
    <h5><span class="badge bg-danger" id="{{prefix3}}_connect_status">Not running</span></h5>
</div>
<hr>
<div class="full-width">
    {{ ui_elements.dataLabelWithBadge("Time:", prefix3+"_time") }}
    {{ ui_elements.dataLabelWithBadge("Request Acknowledge:", prefix3+"_request_id") }}
    {{ ui_elements.dataLabelWithBadge("Expiry Date:", prefix3+"_expiry_date") }}
    {{ ui_elements.dataLabelWithBadge("Status:", prefix3+"_busy_status") }}
    {{ ui_elements.dataLabelWithBadgeAndInput('X:', prefix3+'_first', prefix3+'_first_request', 'X') }}
    {{ ui_elements.dataLabelWithBadgeAndInput('Y:', prefix3+'_second', prefix3+'_second_request', 'Y') }}
</div>
<div class="push-right">
    {{ ui_elements.buttonSpinner('Submit', prefix3 + '_submit_spinner', 'itf.onSubmitAmlPhiZeta()') }}
    {{ ui_elements.buttonSpinner('Load/Unload', prefix3 + '_load_spinner', 'itf.onLoadAmlPhiZeta()') }}
    {{ ui_elements.buttonSpinner('Continue', prefix3 + '_continue_spinner', 'itf.onContinueAmlPhiZeta()') }}
    {{ ui_elements.buttonSpinner('Hide', prefix3 + '_hide_spinner', 'itf.onHideAmlPhiZeta()') }}
    {{ ui_elements.buttonSpinner('Show', prefix3 + '_show_spinner', 'itf.onShowAmlPhiZeta()') }}
</div>
<div id="{{prefix3}}_error_status"></div>
<div id="{{prefix3}}_request_status"></div>
<hr>
<div class="left-to-right"><h5>CAEN </h5>
    <h5><span class="badge bg-danger" id="{{prefix4}}_connect_status">Not running</span></h5>
</div>
<hr>
<div class="full-width">
    {{ ui_elements.dataLabelWithBadge("Time:", prefix4+"_time") }}
    {{ ui_elements.dataLabelWithBadge("Request Acknowledge:", prefix4+"_request_id") }}
    {{ ui_elements.dataLabelWithBadge("Acquiring Data:", prefix4+"_acquiring_data") }}
    {{ ui_elements.dataLabelWithBadge("Storing list data:", prefix4+"_storing_list_data") }}
    {{ ui_elements.dataLabelWithBadgeAndInput("Histogram folder:", prefix4+"_histogram_folder", "histogram folder") }}
    {{ ui_elements.dataLabelWithBadgeAndInput("List data folder:", prefix4+"_list_data_folder", "list data folder") }}
    {{ ui_elements.dataLabelWithBadgeAndInput("List data timeout (min):", prefix4+"_list_data_timeout", "list data timeout") }}
</div>

<div class="push-right">
    {{ ui_elements.toggleButtonSpinner("Not acquiring data", prefix4+"_toggle_acquisition_text", prefix4+"_toggle_acquisition",
    prefix4+"_toggle_acquisition_spinner", "itf.toggleAcquisition()")}}
    {{ ui_elements.toggleButtonSpinner("Not storing list data", prefix4+"_toggle_list_data_text", prefix4+"_toggle_list_data",
    prefix4+"_toggle_list_data_spinner", "itf.toggleListData()")}}

    {{ ui_elements.buttonSpinner('Clear Data', 'caen_clear_data_spinner', 'itf.caenClearData()') }}
    {{ ui_elements.buttonSpinner('Save histogram', 'caen_save_histogram_spinner', 'itf.caenSaveHistogram()') }}
    {{ ui_elements.buttonSpinner('Continue', 'caen_continue_spinner', 'itf.caenContinueOnError()') }}
    {{ ui_elements.buttonSpinner('Save registry', 'caen_save_registry_spinner', 'itf.caenSaveRegistry()') }}
</div>
<div id="{{prefix4}}_error_status"></div>
<div id="{{prefix4}}_request_status"></div>
</div>

{% endblock %}
